<!DOCTYPE html>
<html>
<head>
    <meta charset="gbk" />
    <title>sys.opensearch</title>
    <link href="/fdevlib/static/css/merge.css" rel="stylesheet"/>
    <script src="/fdevlib/static/js/merge-fdev3.js"></script>
</head>
<body>
    <div class="g-memo">
        <h2>
            OpenSearch: ASC OpenSearch 接口</h2>
        <h3>
            更新日志</h3>
        <ul class="update-histroy">
            <li>2010.08.02 发布1.0 Beta版</li>
            <li>2010.08.30 发布1.0 Beta 2版</li>
            <li>2010.11.12 发布1.1 Beta 1版</li>
        </ul>
    </div>
    <div class="g-detail">
        <h3>
            开始：</h3>
        如果你想调用OpenSearch接口，请在页面中加入以下片段片段:
        <pre class="brush:js">
ImportJavscript.url("http://style.china.alibaba.com/js/lib/fdev-v3/core/fdev-min.js");
ImportJavscript.url("http://style.china.alibaba.com/js/lib/fdev-v3/core/yui/get-min.js");
ImportJavscript.url("http://style.china.alibaba.com/js/sys/opensearch/core/opensearch.js");
/*此js为theme js，根据不同theme引用相应js*/
ImportJavscript.url("http://style.china.alibaba.com/js/sys/opensearch/themes/classic.js");
        </pre>
        <p><strong>注意：</strong>OpenSearch只能china.alibaba.com/alibaba-inc.com域名下才能使用</p>
        <h3>使用说明：</h3>
        <p>1、需要的html结构，仅一个空容器：</p>
        <pre class="brush:html">
<div id="opensearch-demo"></div>
            </pre>
        <p>2、引入相应theme的css文件，以 theme classic 为例：</p>
        <pre class="brush:css">
<link href="http://style.china.alibaba.com/css/lib/fdev-v3/fdev.css" rel="stylesheet"/>
<link href="http://style.china.alibaba.com/css/app/operation/global/v2.css" rel="stylesheet"/>
<link href="http://style.china.alibaba.com/css/sys/opensearch/themes/classic.css" rel="stylesheet"/>
        </pre>
        <p>3、调用方法：第一组参数为接口参数对象，第二组参数为theme参数对象</p>
        <pre class="brush:js">
FD.sys.opensearch.Ao(
    { /* OpenSearch接口参数设置 */
        'returnJsonObjectName':'opensearchDemo', /* 返回json名 */
        'fromId':'opensearch', /* opensearch表单的id，必须指定，默认值为"opensearch" */
        'search_type':'offer', /* 搜索类型，必须指定，默认值为"offer" */
        'imageFlag':1' /* offer是否有图，默认值为1，即有图 */
        ...
    },
    { /* theme参数设置 */
        'containerId':'opensearch-demo', /* 展示结果的空容器的id */
        'theme':'classic', /* theme name */
        'imgType':1 /* offer图片类型，0：100px*100px；1：150px*150px；2：220px*220px；3：310px*310px */
        ...
    }
).use(FD.sys.opensearch.opensearchDemo); /* OpenSearch实例名 */
        </pre>
        <h3>参数列表</h3>
        <p>OpenSearch入参详细列表、返回字段详细列表<a href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=41094362" target="_blank">请猛击这里</a></p>
        <h3>公用方法</h3>
        <table class="g-paramtable">
            <thead>
                <tr>
                    <th>方法名</th>
                    <th>参数说明</th>
                    <th>返回值</th>
                    <th>作用说明</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>FD.sys.opensearch.Util.log</td>
                    <td>
                        {String} message<br/>
                        {String} firebug message status
                    </td>
                    <td>firebug log</td>
                    <td>firebug提示信息</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.toFixed</td>
                    <td>
                        {Int} value数字<br/>
                        {Int} fraction digits小数位
                    </td>
                    <td>{Int} value</td>
                    <td>数字四舍五入，修复IE bug</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.resizeImage</td>
                    <td>
                        {Object} image<br/>
                        {Int} width<br/>
                        {Int} height
                    </td>
                    <td>{Object} image</td>
                    <td>重置图片大小，此方法只在页面上配合img标签的onload使用，且需对img设置范围大小</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.getOfferDetailUrl</td>
                    <td>{Int} offerId</td>
                    <td>{String} offer detail url</td>
                    <td>获取offer detail url</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.getOfferSearchUrl</td>
                    <td>
                        {String} keywords<br/>
                        {String} displayCatIds<br/>
                        {Int} offerId<br/>
                        {Boolean} isEtc<br/>
                        {String} feature (offer特征)
                    </td>
                    <td>{String} offer search url</td>
                    <td>获取offer search url</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.getOfferUrl</td>
                    <td>
                        {String} urlType (offer url类型: search or detail)<br/>
                        {Int} privateInfo<br/>
                        {String} keywords<br/>
                        {String} displayCatIds<br/>
                        {Int} offerId<br/>
                        {Boolean} isEtc<br/>
                        {String} feature (offer特征)
                    </td>
                    <td>{String} offer search url</td>
                    <td>获取offer url，当private offer或选择detail url类型时，返回detail型url，余则返回search型url</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.getOfferImgUrl</td>
                    <td>
                        {String} offerImgURI<br/>
                        {Int} image type, 0:100x100, 1:150x150, 2:220x200, 3:310x310<br/>
                        {Boolean} isImgPrivate (offer图是否私密)
                    </td>
                    <td>{String} offer image url</td>
                    <td>获取offer图片。若对私密图片有遮罩需求，目前不可使用此方法</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.getCompanyUrl</td>
                    <td>
                        {String} trustType<br/>
                        {String} domainId<br/>
                        {String} memberId
                    </td>
                    <td>{String} company url</td>
                    <td>获取商家url</td>
                </tr>
                <tr>
                    <td>FD.sys.opensearch.Util.tracelog</td>
                    <td>
                        {String} tracelog param<br/>
                    </td>
                    <td>to do tracelog</td>
                    <td>tracelog打点</td>
                </tr>
            </tbody>
        </table>
        <h3>theme制作</h3>
        <p>theme需作为FD.sys.opensearch.theme的子对象存在，且必须存在getHtmlRoot、getErrorTips两个方法</p>
        <p>theme只做数据渲染，不用再做数据判断、逻辑判断</p>
        <p>以下为示例：</p>
        <pre class="brush:js">
(function( win, S ){
    S.theme.themeName = { /* themeName为新作theme name*/
        getHtmlRoot: function( result, customize, config ){
            /**
             * 返回数据渲染的HTML
             * result：取得的json数据
             * customize：theme参数
             * config：接口参数
             */
            ...
        },
        getErrorTips: function( customize, txt ){
            /**
             * 返回错误提示
             * customize：theme参数
             * txt：非成功状态文本，为"failure"、"timeout"、"progress"之一
             */
            ...
        }
        ...
    };
})( window, FD.sys.opensearch );
        </pre>
        <h3>
            提建议给开发者</h3>
        作者：Edgar<br />
        邮件：<a href="mailto:mail@edgarhoo.net">mail@edgarhoo.net</a><br />
        旺旺：edgarhoo（中文站）
    </div>
</body>
</html>
